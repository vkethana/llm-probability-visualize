<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Area Submission</title>
    <style>
      body { 
        max-width: 750px; 
        margin: 40px auto; 
        padding: 0 10px; 
        font: 12px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; 
        color: #444 
      } 
      h1,h2,h3 { 
        line-height: 1.2;
        text-align: center;
      } 
      h4 { 
        line-height: 0.5 
      } 
      #container {
          display: flex;
          align-items: flex-start;
          gap: 20px;
      }
      #textForm {
          margin-right: 20px;
      }
      #resultTable {
          border-collapse: collapse;
          width: 150px; /* Set a fixed width for the table */
      }
      #resultTable th, #resultTable td {
          border: 1px solid black;
          padding: 8px;
      }
      #resultTable th {
          background-color: #f2f2f2;
      }
    </style>
</head>
<body>
    <div id="container">
        <form id="textForm" action="/submit" method="post">
            <textarea id="textarea" name="content" rows="10" cols="30"></textarea>
            <br>
            <button type="submit">Submit</button>
        </form>

        <table id="resultTable">
            <thead>
                <tr>
                    <th>Word</th>
                    <th>%</th>
                </tr>
            </thead>
            <tbody id="resultTableBody">
            </tbody>
        </table>
    </div>

    <script>
        document.getElementById('textForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(this);

            fetch('/submit', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('textarea').value = data["modified_content"].replace(/\\n/g, '\n');
                const tableBody = document.getElementById('resultTableBody');
                table = data['table'];
                // Sort the table based on probability
                table = Object.fromEntries(Object.entries(table).sort((a, b) => b[1] - a[1]));

                tableBody.innerHTML = ""; // Clear previous table contents
                for (const [word, probability] of Object.entries(table)) {
                    console.log(word, probability);
                    const row = document.createElement('tr');
                    const wordCell = document.createElement('td');
                    const probabilityCell = document.createElement('td');
                    wordCell.innerText = word;
                    probabilityCell.innerText = probability;
                    if (word == data["largest_prob_token"]) {
                        wordCell.style.backgroundColor = 'yellow';
                        probabilityCell.style.backgroundColor = 'yellow';
                    }
                    row.appendChild(wordCell);
                    row.appendChild(probabilityCell);
                    tableBody.appendChild(row);
                }
            });
        });
    </script>
</body>
</html>

